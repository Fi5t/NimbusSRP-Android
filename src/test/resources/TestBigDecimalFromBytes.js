
// import test untils
load("src/test/resources/JsUnitUtils.js");

load("src/main/resources/biginteger.js");
load("src/main/resources/sha256.js");

/**
java big int values as decimal, hex and byte array generated as "new BigDecimal(1, bytes);"
*/
var testSet = [
{ d: "97568260925012193092143012635714532642305920413210231315769093288362620997087",
h: "d7b5adbf596c00c7ac4299d7a3da3aa2585f68ff8b2c8bd72216abb41cf7cddf",
b: [ -41,-75,-83,-65,89,108,0,-57,-84,66,-103,-41,-93,-38,58,-94,88,95,104,-1,-117,44,-117,-41,34,22,-85,-76,28,-9,-51,-33 ]
},
{ d: "61824886430791842528302482593560505118275306399522199209137998321437137736165",
h: "88afa54a257d5ac024baff0412ad4c0a98e3aea3308c9d69fc6b50e5146491e5",
b: [ -120,-81,-91,74,37,125,90,-64,36,-70,-1,4,18,-83,76,10,-104,-29,-82,-93,48,-116,-99,105,-4,107,80,-27,20,100,-111,-27 ]
},
{ d: "13924584577045032957455825767115178433916260829383065355119384142751170948303",
h: "1ec9091b96e4a66a1dc01e007a6b798b42148c359c4ba6b1c6204ba0c2f1eccf",
b: [ 30,-55,9,27,-106,-28,-90,106,29,-64,30,0,122,107,121,-117,66,20,-116,53,-100,75,-90,-79,-58,32,75,-96,-62,-15,-20,-49 ]
},
{ d: "1886673302870708765519608212440512725117967562970985664037742089811979972561",
h: "42bd1ba3186742ad0eb52b168e1570c6b43be775a618aae6617cedf3bf4afd1",
b: [ 4,43,-47,-70,49,-122,116,42,-48,-21,82,-79,104,-31,87,12,107,67,-66,119,90,97,-118,-82,102,23,-50,-33,59,-12,-81,-47 ]
},
{ d: "86934164479962555054187588362078535663232914263409558908463947207430318354791",
h: "c032fe4ff0827587ab55121061157918c8ca4c32751b7dbaa3a85d8060187167",
b: [ -64,50,-2,79,-16,-126,117,-121,-85,85,18,16,97,21,121,24,-56,-54,76,50,117,27,125,-70,-93,-88,93,-128,96,24,113,103 ]
},
{ d: "62999126780789587819303887892151431430345872082805820728652200280103211067958",
h: "8b483dfd6eb2ad1217237f79732ad35c590bc99bab41197d7134e1467d296a36",
b: [ -117,72,61,-3,110,-78,-83,18,23,35,127,121,115,42,-45,92,89,11,-55,-101,-85,65,25,125,113,52,-31,70,125,41,106,54 ]
},
{ d: "98240060822454645292333216406848120682902247781085225853199741460181665798168",
h: "d931e76a772e619919172ec83cdc4c4c9994856102251d4a16935ad00a255818",
b: [ -39,49,-25,106,119,46,97,-103,25,23,46,-56,60,-36,76,76,-103,-108,-123,97,2,37,29,74,22,-109,90,-48,10,37,88,24 ]
},
{ d: "14024287765971477273875925816747313786098106174739007957282888400477558547697",
h: "1f01773067d0004b011b84769f13f481ddd8a04d842c0e01229e68eb427224f1",
b: [ 31,1,119,48,103,-48,0,75,1,27,-124,118,-97,19,-12,-127,-35,-40,-96,77,-124,44,14,1,34,-98,104,-21,66,114,36,-15 ]
},
{ d: "49576128274453018573960081930063359372724405496856504113550736001004169055888",
h: "6d9b181f3a8be58397f45b32bd24c26f669aee1dd07039192584eabf254bce90",
b: [ 109,-101,24,31,58,-117,-27,-125,-105,-12,91,50,-67,36,-62,111,102,-102,-18,29,-48,112,57,25,37,-124,-22,-65,37,75,-50,-112 ]
},
{ d: "27533866898702896515401032665544760291671939799676324558970943790985131952076",
h: "3cdf9dcc875dd9c3b5ba9e17e24a094c07297c5586c3be66e590a6ba30a987cc",
b: [ 60,-33,-99,-52,-121,93,-39,-61,-75,-70,-98,23,-30,74,9,76,7,41,124,85,-122,-61,-66,102,-27,-112,-90,-70,48,-87,-121,-5 ],
}
];

tests({

	saltSanityCheck: function() {
		for( var i = 0; i < testSet.length; i++ ) {
			var datum = testSet[0];
			
			var h = datum.h;	
			var bs = datum.b;
			var hbs = moduleSHA256.bytes2hex(bs);
	
			assert.assertEquals(""+h, ""+hbs);
			
			var bi1 = new BigInteger(h);
			var bi2 = new BigInteger(hbs);
			
			assert.assertEquals(bi1.toString(), bi2.toString());
		}
	}
});
